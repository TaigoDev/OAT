@page "{id?}"

@using OMAVIAT.RazorPages.Components
@using OMAVIAT.Services.News
@model ProjectNewsModel
@{
	ViewData["Title"] = "Новости проекта";
}

<link rel="stylesheet" href="~/css/allNews.css">
<script src="~/js/allNews.js" asp-append-version="true"></script>

<div class="container content-page">
	<section class="content">
		<h2 class="section-title">
			Новости проекта
		</h2>

		@if (ProfNewsReader.news.Count() != 0 && ProfNewsReader.pages.Count() >= Model.id)
		{
			<div class="news-list" style="max-width: none;">
				@foreach (var news in ProfNewsReader.pages.ToList()[Model.id])
				{
					var photos = news.GetPhotos();
					if (photos.Count is 0)
						continue;
					<div class="news-item">
						<a class="news-item-img" href="news/@news.id">
							@if (photos.Count > 0)
							{
								<img src="/@photos.FirstOrDefault()" alt="">
							}
						</a>
						<div class="news-item-content">
							<div class="news-item-date">
								@news.date
							</div>
							<div class="news-item-title">
								@news.title
							</div>
							<div class="news-item-info">
								@Html.Raw(news.short_description)
								<a href="news/@news.id">
									ещё...
								</a>
							</div>
						</div>
					</div>
				}
			</div>
			@(await Html.RenderComponentAsync<PagesComponent>(RenderMode.Static, new
			{
				CurrentPage = Model.id + 1,
				count = ProfNewsReader.news.Count(),
				countInPage = 10,
				UrlWithParameter = "/projectsAndEvents/professionalitet/ProjectNews/{id}"
			}))
		}
		else
		{
			<p>Новостей нет</p>
		}
	</section>

	<aside id="sidebar" class="sidebar">
		<h3 class="sidebar-title">
			Профессионалитет
		</h3>
		<nav class="sidebar-body">
			<ul class="sidebar-links">
				<li class="sidebar-link">
					<a asp-page="About">
						О профессионалитете
					</a>
				</li>
				<li class="sidebar-link">
					<a asp-page="Specialities">
						Специальности
					</a>
				</li>
				<li class="sidebar-link">
					<a asp-page="OPOPP">
						ОПОП-П
					</a>
				</li>
				<li class="sidebar-link">
					<a asp-page="Partners">
						Участники кластера
					</a>
				</li>
				<li class="sidebar-link">
					<a asp-page="ManagementCompany">
						Управляющая компания
					</a>
				</li>
				<li class="sidebar-link">
					<a asp-page="/applicant/AdmissionRules">
						Правила приёма
					</a>
				</li>
				<li class="sidebar-link sidebar-link-selected">
					<a asp-page="ProjectNews">
						Новости проекта
					</a>
				</li>
			</ul>
		</nav>
	</aside>
</div>